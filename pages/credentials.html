<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="/images/favicon.png" sizes="32x32">

    <meta property="og:title" content="Vlad Gavrilov 路 Learning Credentials">
    <meta property="og:description" content="Verified courses, specializations, and project credentials">
    <meta property="og:image" content="https://vlad-gavrilov.dev/images/preview.png">
    <meta property="og:url" content="https://vlad-gavrilov.dev/pages/credentials.html">
    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Vlad Gavrilov 路 Learning Credentials">
    <meta name="twitter:description" content="Verified courses, specializations, and project credentials">
    <meta name="twitter:image" content="https://vlad-gavrilov.dev/images/preview.png">

    <title>Vlad Gavrilov 路 Learning Credentials</title>
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/credentials.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
</head>

<body class="credentials-page">
    <div id="tsparticles"></div>

    <div id="container">
        <header class="credentials-header">
            <img src="/images/avatar.jpg" alt="Vlad Gavrilov avatar" class="avatar" />
            <div class="intro">
                <h1>Learning Credentials</h1>
                <p>Verified courses, specializations, and guided projects</p>
                <a class="back-link" href="../index.html"><i class="fas fa-arrow-left"></i> Back to main page</a>
            </div>
        </header>

        <section>
            <h2 class="section-title">Credentials</h2>
            <div class="section-content">
                <div class="certificates-grid" id="certificates-grid">
                    <p class="certificates-loading">Loading certificates...</p>
                </div>
            </div>
        </section>

        <div class="footer">
            <a href="https://github.com/vlad-gavrilov" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-github"></i> GitHub</a> |
            <a href="https://www.linkedin.com/in/vlad-gavrilov-dev" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-linkedin"></i> LinkedIn</a> |
            <a href="https://t.me/gvv_dev" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-telegram-plane"></i> Telegram</a> |
            <a href="https://www.codewars.com/users/vlad-gavrilov" target="_blank" rel="noopener noreferrer"><i
                    class="fas fa-code"></i> CodeWars</a> |
            <a href="https://keybase.io/gvv_dev" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-keybase"></i> Keybase</a>
        </div>
    </div>

    <script>
        const certificatesGrid = document.getElementById('certificates-grid');

        function formatCertificateType(type) {
            if (!type) {
                return 'Certificate';
            }
            return type.charAt(0).toUpperCase() + type.slice(1);
        }

        function formatEuropeanDate(isoDate) {
            if (!isoDate) {
                return '';
            }

            const parsedDate = new Date(`${isoDate}T00:00:00`);
            if (Number.isNaN(parsedDate.getTime())) {
                return '';
            }

            return new Intl.DateTimeFormat('de-DE', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            }).format(parsedDate);
        }

        function buildCard(certificate) {
            const card = document.createElement('article');
            card.className = 'certificate-card';

            const head = document.createElement('div');
            head.className = 'certificate-head';

            const icon = document.createElement('span');
            icon.className = 'certificate-icon';
            const iconGlyph = document.createElement('i');
            iconGlyph.className = 'fas fa-certificate';
            icon.appendChild(iconGlyph);
            head.appendChild(icon);

            const headBody = document.createElement('div');

            const title = document.createElement('h3');
            title.textContent = certificate.courseName || 'Untitled certificate';
            headBody.appendChild(title);

            const subtitle = document.createElement('p');
            const platform = certificate.platformName || 'Platform';
            const type = formatCertificateType(certificate.certificateType);
            subtitle.textContent = `${platform} 路 ${type}`;
            headBody.appendChild(subtitle);

            head.appendChild(headBody);
            card.appendChild(head);

            const metaList = document.createElement('ul');
            metaList.className = 'certificate-meta';

            if (certificate.authorizedBy) {
                addMetaItem(metaList, 'fas fa-university', certificate.authorizedBy);
            }

            const displayDate = formatEuropeanDate(certificate.issueDateIso);
            if (displayDate) {
                addMetaItem(metaList, 'far fa-calendar-alt', displayDate);
            }

            if (certificate.certificateId) {
                addMetaItem(metaList, 'fas fa-fingerprint', `ID: ${certificate.certificateId}`);
            }

            if (metaList.children.length > 0) {
                card.appendChild(metaList);
            }

            const button = document.createElement('a');
            button.className = 'certificate-button';
            button.textContent = 'Open Certificate';
            button.target = '_blank';
            button.rel = 'noopener noreferrer';

            if (certificate.certificateUrl) {
                button.href = certificate.certificateUrl;
            } else {
                button.href = '#';
                button.classList.add('certificate-button-disabled');
                button.setAttribute('aria-disabled', 'true');
            }

            card.appendChild(button);
            return card;
        }

        function addMetaItem(metaList, iconClass, text) {
            const item = document.createElement('li');
            const icon = document.createElement('i');
            icon.className = iconClass;
            const content = document.createElement('span');
            content.textContent = text;
            item.appendChild(icon);
            item.appendChild(content);
            metaList.appendChild(item);
        }

        async function loadCertificates() {
            try {
                const response = await fetch('../data/credentials.json', { cache: 'no-store' });
                if (!response.ok) {
                    throw new Error(`Request failed with status ${response.status}`);
                }

                const payload = await response.json();
                const certificates = Array.isArray(payload.certificates) ? payload.certificates : [];

                const sorted = [...certificates].sort((a, b) => {
                    const aDate = Date.parse(a.issueDateIso || '') || 0;
                    const bDate = Date.parse(b.issueDateIso || '') || 0;
                    if (aDate !== bDate) {
                        return bDate - aDate;
                    }
                    return (a.courseName || '').localeCompare(b.courseName || '');
                });

                certificatesGrid.innerHTML = '';

                if (sorted.length === 0) {
                    certificatesGrid.innerHTML = '<p class="certificates-loading">No certificates found.</p>';
                    return;
                }

                for (const certificate of sorted) {
                    certificatesGrid.appendChild(buildCard(certificate));
                }
            } catch (error) {
                certificatesGrid.innerHTML = '<p class=\"certificates-loading\">Failed to load certificates JSON.</p>';
                console.error('Failed to load certificates:', error);
            }
        }

        loadCertificates();

        tsParticles.load('tsparticles', {
            fpsLimit: 60,
            particles: {
                number: { value: 70, density: { enable: true, area: 800 } },
                color: { value: '#007bff' },
                shape: { type: 'circle' },
                opacity: { value: 0.5 },
                size: { value: { min: 1, max: 4 } },
                links: { enable: true, color: '#007bff', distance: 130, opacity: 0.3, width: 1 },
                move: { enable: true, speed: 1, outModes: { default: 'bounce' } }
            },
            interactivity: {
                events: {
                    onHover: { enable: true, mode: 'grab' },
                    onClick: { enable: true, mode: 'push' }
                },
                modes: {
                    grab: { distance: 140, links: { opacity: 0.5 } },
                    push: { quantity: 4 }
                }
            },
            detectRetina: true,
            background: { color: '#f0f0f0' }
        });
    </script>
</body>

</html>
